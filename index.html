<!DOCTYPE html>
<html>
    <head>
        <title>Rock Papaer Scissors</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

        <style>
            body{
                margin-top: 40px;
                display: flex;
                justify-content: center;
                /*align-items: center;*/
                height: 80vh;
                /*background-color: hsl(0, 0%, 95%);*/
                background-image: url('tiles.jpg');
                background-size: cover; /* This ensures the background image covers the entire viewport */
                background-position: center; /* Center the background image */
                background-repeat: no-repeat; /* Prevent the background image from repeating */

            }

            #container {
                font-family: Arial, Helvetica, sans-serif;
                background-color: hsl(0, 0%, 15%);
                padding: 20px;
                border-radius: 15px;
                width: auto;
                max-width: 100%;
                position: relative; /* Ensure position is relative for animation */
                opacity: 0.9;
            }
            
            
            .animate {
                animation: example 0.25s linear; /* Apply animation with linear timing function */
            }
            
             
            @keyframes example {
                0%   { top: 0px; }
                25%  { top: 0px; } /* Adjusted position */
                50%  { top: 0px; }
                75%  { top: 0px; } /* Adjusted position */
                100% { top: 0px; }
            }
            

            p{
                color: white;
                margin-left: 15px;
                font-size:32px;
                width: 300px;
                
            }

            /* Define the shake animation */
            @keyframes shake {
                0% { transform: rotate(-35deg); }
                25% { transform: rotate(35deg); }
                50% { transform: rotate(-35deg); }
                75% { transform: rotate(35deg); }
                100% { transform: rotate(0); }
            }

            /* Apply the shake animation to the button */
            .shake {
                animation: shake 0.8s ease-in-out; /* Adjust duration and timing function as needed */
            }

            /* Define the reset animation */
            @keyframes rotateVertical {
                0% { transform: rotateX(0deg); }
                100% { transform: rotateX(360deg); }
            }

            /* Apply the rotateVertical animation to the reset button */
            #resetAll.rotate {
                animation: rotateVertical 0.75s linear !important; /* Adjust duration and timing function as needed */
            }

            img {
                width: 50px;
                margin-bottom: 0;
            }

            img.me{
                margin-bottom: 0px;
                padding-bottom:5px;
            }

            .rock, .paper, .scissors {
                background-color: hsl(0, 0%, 15%);
                color: white;
                margin-left: 20px;
                border-radius: 50px;
                height: 75px;
                width: 75px;
                border-color: none;
                border-width: 0px;
                margin-bottom: 0;
                margin-top: 0;
            }

            table {
                border-collapse: collapse;
                margin-top: 20px;
                margin-left: 20px;
              }

            th, td {
            border: 1px solid hsl(0, 0%, 15%);
            color: white;
            padding: 8px;
            text-align: center;
            }

            .resetGame{
                background-color: black;
                color: white;
                border: solid;
                border-color: white;
                border-radius: 6px;
                border-width: 1px;
                padding: 5px;
                display: flex;
                text-align: center;
                margin-top: 20px;
                margin-left: 90px;
            }

            .resetGame:hover {
                cursor: pointer;
                background-color: white;
                color: black;
            }

            .summary {
                color: white;
                margin-top: 20px;
                margin-left: 0px;
                width: 325px;
                text-align: center;
                line-height: 30px;
            }

            .stats {
                color: white;
                margin-top: 35px;
                margin-left: 50px;
                width: 300px;
            }

            @media (max-width: 768px) {
                #calculator {
                    width: 90%; /* Adjust as needed for smaller screens */
                }
            }

            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(0.7); }
                100% { transform: scale(1); }
            }
              
            .pulse-red {
                animation: pulse 1.5s infinite, color-pulse 1.5s infinite alternate;
            }
              
            @keyframes color-pulse {
                0% { color: white; }
                100% { color: white; }
            }
              


            #datetime{
                color: white;
                padding: 12px;
                opacity: 0.6;
            }

            .thursday{
                font-size: smaller;
                opacity: 0.6;
                
            }

            .me{
                width: 120px;
                height: auto;
                border-radius: 25px;
                padding: 15px;
                margin-bottom: 10px;
            }

            button.developBtn{
                background-color:hsl(0, 0%, 15%);
                margin-left: 15px;
                color: white;
                border-radius: 20px;
                opacity: 0.6;
                
            }
            p.js-jake{
                font-size: medium;
            }
            p.js-dylan{
                margin-bottom: 0px;
            }

            
        </style>
    </head> 
    <body>

    <!--<button>Start</button>
        <button class = "js-button">Second Button</button>-->
    
        

    <div id="container"> 
        <div id="datetime"></div>
        <button type="button" class="developBtn" data-bs-toggle="collapse" data-bs-target="#demo">Developer</button>
        <div id="demo" class="collapse">
            <img class = "me" src="lwj.jpg">
            <p class ="thursday">LWJ</p>
        </div>
        
        <p class = "js-dylan" >Rock Paper Scissors</p>
        <p id="maxAttemptsMessage" class="js-jake">Max Attempts = 20</p>


        <button class = "rock" id = "rockButton">
            <img src = "rock-emoji.png">
        </button>
        <button class = "paper" id = "paperButton">
            <img src = "paper-emoji.png">
        </button>
        <button class = "scissors" id = "scissorsButton">
            <img src = "scissors-emoji.png">
        </button>

        <div class = "summary" id="result"></div>
        
        <table id="tally">
        <tr>
            <th>Wins</th>
            <th>Ties</th>
            <th>Losses</th>
            <th>Attempts</th>
        </tr>
        <tr>
            <td id="wins">0</td>
            <td id="ties">0</td>
            <td id="losses">0</td>
            <td id="attempts">0</td>
        </tr>
        </table>

        <button class = "resetGame" id = resetAll>Reset Game</button>
        

        <div class = "stats" id="outcome"></div>
    </div>
    
        <script>

        

        // Function to add shake animation to the button
        function shakeButton(button) {
            button.classList.add('shake');
            
            // Remove the shake class after the animation completes
            setTimeout(function() {
                button.classList.remove('shake');
            }, 500); // Duration of the animation
        }

        
        
        // Function to change button color when clicked or touched and revert it back after a short delay
        /*function changeButtonColor(button) {
            button.style.backgroundColor = "white"; // Change color when clicked or touched
            setTimeout(function() {
            button.style.backgroundColor = "hsl(0, 0%, 15%)"; // Change back after a short delay
            }, 300);
        }
        
        
        // Get all buttons with the specified IDs
        //var buttons = document.querySelectorAll("#rockButton, #paperButton, #scissorsButton");
        var buttons = document.querySelectorAll(".rock, .paper, .scissors");
        
        // Loop through each button and add event listeners for both mouse and touch events
        buttons.forEach(function(button) {
            button.addEventListener("mousedown", function(event) {
            event.preventDefault(); // Prevent default mouse behavior (e.g., text selection)
            changeButtonColor(button); // Change button color
            });
        
            button.addEventListener("touchstart", function(event) {
            event.preventDefault(); // Prevent default touch behavior (e.g., scrolling)
            changeButtonColor(button); // Change button color
            });
        });*/
        function updateMaxAttemptsMessage(attempts) {
            console.log("Hello")
            console.log(attempts)
            var maxAttemptsMessage = document.getElementById("maxAttemptsMessage");
            if (attempts >= 19) {
              maxAttemptsMessage.classList.add("pulse-red");
            } else {
              maxAttemptsMessage.classList.remove("pulse-red");
            }
        }
          
        

        function updateDateTime() {
            const currentDate = new Date();
            const dateElement = document.getElementById("datetime");
            
            // Options for formatting the date
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            
            // Format the date and time separately
            const formattedDate = currentDate.toLocaleDateString(undefined, dateOptions);
            const formattedTime = currentDate.toLocaleTimeString(undefined, timeOptions);
            
            // Update the date element with both date and time
            dateElement.textContent = `${formattedDate} ${formattedTime}`;
        }
        
        // Call updateDateTime function initially
        updateDateTime();
        
        // Set interval to update every second
        setInterval(updateDateTime, 1000);
        


            //document.title = "DOM";
            //console.log(document.body.innerHTML)
            //console.log(document.querySelector('.resetGame').innerHTML);

            //document.querySelector('button')
                //.innerHTML = 'Start1';

            //document.querySelector('.js-button')
                //.innerHTML = 'Start2';
                
            //document.querySelector('.js-dylan')
                //.innerHTML = "Dylan's Rock, Paper, Scissors Game";

                // Declare variables outside of the onclick handlers
            let randomNumber, computerMove;
            let wins = 0, ties = 0, losses = 0, count;
            let attempts = 0;
            const maxAttempts = 20;
            let success = 0

            

            function getImageUrl(move) {
                switch (move) {
                    case 'rock':
                        return 'rock-emoji.png';
                    case 'paper':
                        return 'paper-emoji.png';
                    case 'scissors':
                        return 'scissors-emoji.png';
                    default:
                        return '';
                }
            }
            



            function resetGame() {
                wins = 0;
                ties = 0;
                losses = 0;
                attempts = 0;
                success = 0;
                
                // Update tally table
                document.getElementById('wins').textContent = wins;
                document.getElementById('ties').textContent = ties;
                document.getElementById('losses').textContent = losses;
                document.getElementById('attempts').textContent = attempts;
                
                // Clear result and outcome
                document.getElementById('result').textContent = '';
                document.getElementById('outcome').textContent = '';
                
                // Reset button states
                document.getElementById('rockButton').disabled = false;
                document.getElementById('paperButton').disabled = false;
                document.getElementById('scissorsButton').disabled = false;
                
                console.log("Reset game function called"); // Add this line for debugging

                // Trigger the reset animation
                var resetButton = document.getElementById('resetAll');
                
                // Remove any existing animation classes
                resetButton.classList.remove('rotate');
            
                // Add a class to trigger the animation
                resetButton.classList.add('rotate');
            
                // Remove the class after the animation completes
                resetButton.addEventListener('animationend', function() {
                    resetButton.classList.remove('rotate');
                }, { once: true }); // Remove the event listener after it's triggered once

                // Remove the pulsing effect from max attempts message
                var maxAttemptsMessage = document.getElementById("maxAttemptsMessage");
                maxAttemptsMessage.classList.remove("pulse-red");

            }
            
            // Function to trigger animation
            function triggerAnimation() {
                var container = document.getElementById('container');
                container.classList.add('animate');

                // Reset animation after a delay longer than the animation duration
                setTimeout(function() {
                    container.classList.remove('animate');
                }, 2500); // Adjust this value to ensure it's longer than the animation duration
            }

            // Function to generate computer move and display result
            function playGame(playerMove, choice) {
                updateMaxAttemptsMessage(attempts);
                console.log(playerMove)
                //localStorage.removeItem('attempts'); // Removes the item with key 'key2'
                //console.log(localStorage.getItem('attempts'))
                // Increment attempts
                // Check if maximum attempts have been reached before playing the game
                // Check if maximum attempts have been reached before playing the game
                // Increment attempts
                attempts++;

                // Generate random number
                randomNumber = Math.random();
                
                // Determine computer move based on random number
                if (randomNumber >= 0 && randomNumber < 1 / 3) {
                computerMove = 'rock';
                } else if (randomNumber >= 1 / 3 && randomNumber < 2 / 3) {
                computerMove = 'paper';
                } else if (randomNumber >= 2 / 3 && randomNumber < 1) {
                computerMove = 'scissors';
                }

                // Determine result
                let result;
                if (playerMove === computerMove) {
                result = 'Tie.';
                ties++;
                } else if (
                (playerMove === 'rock' && computerMove === 'scissors') ||
                (playerMove === 'paper' && computerMove === 'rock') ||
                (playerMove === 'scissors' && computerMove === 'paper')
                ) {
                result = 'You win.';
                wins++;
                } else {
                result = 'You lose.';
                losses++;
                }
                
                // Update tally table
                document.getElementById('wins').textContent = wins;
                document.getElementById('ties').textContent = ties;
                document.getElementById('losses').textContent = losses;
                document.getElementById('attempts').textContent = attempts;


                success = ((wins/attempts)*100).toFixed(1);

                let resultStyle = '';
                if (result === 'You win.') {
                    resultStyle = 'font-weight: bold; font-size: 24px';
                } else if (result === 'You lose.') {
                    resultStyle = 'font-weight: bold; font-size: 24px';
                }
                else {
                    resultStyle = 'font-weight: bold; font-size: 24px';
                }

                
                localStorage.setItem('attempts', JSON.stringify(attempts));



                // Display result
                //document.getElementById('result').textContent = `You picked ${playerMove}. Computer picked ${computerMove}.<br> ${result}`;
                //document.getElementById('result').innerHTML = `You picked ${playerMove}. Computer picked ${computerMove}.<br>${result}`;
                
                //document.getElementById('result').innerHTML = `
                    //You picked <img src="${getImageUrl(playerMove)}" style="width: 30px; height: 30px;"> 
                    //Computer picked <img src="${getImageUrl(computerMove)}" style="width: 30px; height: 30px;">
                    //<br><span style="${resultStyle}">${result}</span>`;


                document.querySelector('.summary').innerHTML = `
                    You picked <img src="${getImageUrl(playerMove)}" style="width: 30px; height: 30px;"> 
                    Computer picked <img src="${getImageUrl(computerMove)}" style="width: 30px; height: 30px;">
                    <br><span style="${resultStyle}">${result}</span>`;

                //document.getElementById('outcome').textContent = `Your success rate =  ${success}%.`;
                
                document.querySelector('.stats').textContent = `Your success rate =  ${success}%.`;
                
                // Disable buttons if maximum attempts reached
                if (attempts >= maxAttempts) {
                    document.getElementById('rockButton').disabled = true;
                    document.getElementById('paperButton').disabled = true;
                    document.getElementById('scissorsButton').disabled = true;
                }

                
                //console.log('wins =', wins, 'attempts =', attempts);
                //console.log('Success Rate = ', success,'%')
                // Trigger animation
                var container = document.getElementById('container');
                container.classList.add('animate');

                // Reset animation after 2 seconds (same duration as animation)
                setTimeout(function() {
                    container.classList.remove('animate');
                }, 2000);

                triggerAnimation(); // Call the function to trigger animation

            }

            // Attach onclick handlers to buttons
            document.getElementById('rockButton').onclick = function () {
                playGame('rock');
                shakeButton(this); // Shake the clicked button
            };
            document.getElementById('paperButton').onclick = function () {
                playGame('paper');
                shakeButton(this); // Shake the clicked button
            };
            document.getElementById('scissorsButton').onclick = function () {
                playGame('scissors');
                shakeButton(this); // Shake the clicked button
            }; 
            document.getElementById('resetAll').onclick = function () {
                resetGame();
                shakeButton(this); // Shake the clicked button
            }; 

            // Attach onclick handler to the reset button
            document.getElementById('resetAll').onclick = function () {
                resetGame();
            };


        </script>
    </body>
</html>
